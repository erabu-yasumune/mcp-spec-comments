# コメント記述ルール

## フォーマット
```
// @spec-impl[状態:TODO|IN_PROGRESS|DONE][優先度:高|中|低][実装順序:数値]
// [実装内容の説明]
//
// 実装要件:
// [要件を箇条書きで記述]
//
// 実装例:
// [具体的な実装手順を擬似コード形式で記述]
// @spec-end
```

## 属性説明

### 状態
- **TODO**: 未実装
- **IN_PROGRESS**: 実装中
- **DONE**: 実装完了

### 優先度
- **高**: 即座に実装が必要、システムの核となる機能
- **中**: 重要だが後回しにできる機能
- **低**: あると便利だが必須ではない機能

### 実装順序
- 数値で実装順序を指定（例: 1, 2, 3...）
- 依存関係がある場合は順序を考慮して設定

## 記述レベル
- 関数・コンポーネント単位で記述
- **実装要件**: 満たすべき条件を箇条書きで明記
- **実装例**: 擬似コード形式で具体的な実装手順を記述
- 必要なライブラリやAPI呼び出しを明記
- エッジケースやエラーハンドリングも記載
- 条件分岐や繰り返し処理の構造を明確に記述

## 記述例

// ========================================
// 例1: Reactコンポーネント
// ========================================

```typescript
// @spec-impl[状態:TODO][優先度:高][実装順序:5]
// ログアウトボタンのクリックハンドラを実装
//
// 実装要件:
// 1. ログアウトボタンと通常リンクを判別
// 2. ログアウト処理にエラーハンドリングを追加
// 3. 適切なHTMLタグを使い分ける
//
// 実装例:
// handleLogoutという非同期関数を作る
//   tryの中で
//     logoutActionを呼び出す
//   エラーが起きたら
//     コンソールに「ログアウトエラー:」とエラー内容を出力
//
// もしitem.nameが「ログアウト」またはitem.hrefが「#logout」なら
//   buttonタグで返す
//     タイプはbutton
//     クリック時にhandleLogoutを実行
//     クラス名はclassName
//     中身はitem.iconとitem.name
// そうでなければ
//   今まで通りの処理
// @spec-end
```

// ========================================
// 例2: クラス定義
// ========================================

```typescript
// @spec-impl[状態:TODO][優先度:中][実装順序:2]
// ユーザー管理クラスを実装
//
// 実装要件:
// 1. データベース接続を保持
// 2. ユーザーの作成・取得・更新・削除ができる
// 3. エラー時は適切に処理
//
// 実装例:
// UserManagerクラスを作る
//   プライベートなdbプロパティを持つ（型はDatabase）
//
//   コンストラクタでdatabaseを受け取る
//     受け取ったdatabaseをthis.dbに保存
//
//   createUserメソッド（非同期）
//     userDataを受け取る
//     tryの中で
//       データベースのusers.createにuserDataを渡して作成
//       結果を返す
//     エラーが起きたら
//       「ユーザー作成エラー:」とログ出力
//       エラーを再度投げる
//
//   getUserメソッド（非同期）
//     userIdを受け取る
//     データベースのusers.findByIdでuserIdを検索
//     見つかったユーザーを返す（なければnull）
//
//   updateUserメソッド（非同期）
//     userIdとupdatesを受け取る
//     データベースのusers.updateでuserIdのユーザーを更新
//     更新されたユーザーを返す
//
//   deleteUserメソッド（非同期）
//     userIdを受け取る
//     データベースのusers.deleteでuserIdのユーザーを削除
// @spec-end
```

// ========================================
// 例3: データ取得関数
// ========================================

```typescript
// @spec-impl[状態:TODO][優先度:中][実装順序:3]
// ユーザーデータを取得して整形する関数
//
// 実装要件:
// 1. リポジトリからユーザー情報を取得
// 2. データがない場合の処理
// 3. データを見やすい形に変換
//
// 実装例:
// fetchFormattedUserという非同期関数を作る
//   userIdを受け取る
//
//   userRepository.findByIdでuserIdを検索してrawUserに入れる
//
//   もしrawUserが存在しなければ
//     nullを返す
//
//   userHelper.formatでrawUserを整形してformattedUserに入れる
//   formattedUserを返す
// @spec-end
```

## 注意事項
- コメントは実装の**前**に配置する
- 実装後もコメントは削除せず、状態を `DONE` に更新する
- 1つのマーカーには1つの責務のみを記述する
- **実装例**は擬似コード形式で記述し、構造を明確にする
- インデントを使って階層構造を表現する
